

























 10%|█████▉                                                     | 95/950 [00:52<05:11,  2.74it/s]


 50%|██████████████████████████████▌                              | 6/12 [00:01<00:02,  2.73it/s]
























 20%|███████████▌                                              | 190/950 [01:46<04:35,  2.76it/s]

 67%|████████████████████████████████████████▋                    | 8/12 [00:02<00:01,  2.60it/s]

























 30%|█████████████████▍                                        | 285/950 [02:39<03:59,  2.77it/s]

 83%|██████████████████████████████████████████████████          | 10/12 [00:03<00:00,  2.57it/s]
























 40%|███████████████████████▏                                  | 380/950 [03:32<03:26,  2.76it/s]


 58%|███████████████████████████████████▌                         | 7/12 [00:02<00:01,  2.61it/s]
















 47%|███████████████████████████▏                              | 445/950 [04:11<04:09,  2.02it/s]Traceback (most recent call last):
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/numpy/core/numerictypes.py", line 320, in issubclass_
    return issubclass(arg1, arg2)
TypeError: issubclass() arg 1 must be a class
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/andreafabbricatore/rainbot/src/train_segments_vit.py", line 128, in <module>
    trainer.train()
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/transformers/trainer.py", line 1553, in train
    return inner_training_loop(
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/transformers/trainer.py", line 1813, in _inner_training_loop
    for step, inputs in enumerate(epoch_iterator):
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/accelerate/data_loader.py", line 561, in __iter__
    next_batch = next(dataloader_iter)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 50, in fetch
    data = self.dataset.__getitems__(possibly_batched_index)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 2876, in __getitems__
    batch = self.__getitem__(keys)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 2872, in __getitem__
    return self._getitem(key)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 2857, in _getitem
    formatted_output = format_table(
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/formatting.py", line 647, in format_table
    formatted_output = formatter(pa_table_to_format, query_type=query_type)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/formatting.py", line 407, in __call__
    return self.format_batch(pa_table)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 112, in format_batch
    batch = self.recursive_tensorize(batch)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 95, in recursive_tensorize
    return map_nested(self._recursive_tensorize, data_struct, map_list=False)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 511, in map_nested
    mapped = [
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 512, in <listcomp>
    _single_map_nested((function, obj, batched, batch_size, types, None, True, None))
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 373, in _single_map_nested
    return function(data_struct)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 89, in _recursive_tensorize
    return self._consolidate([self.recursive_tensorize(substruct) for substruct in data_struct])
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 89, in <listcomp>
    return self._consolidate([self.recursive_tensorize(substruct) for substruct in data_struct])
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 95, in recursive_tensorize
    return map_nested(self._recursive_tensorize, data_struct, map_list=False)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 484, in map_nested
    mapped = function(data_struct)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 89, in _recursive_tensorize
    return self._consolidate([self.recursive_tensorize(substruct) for substruct in data_struct])
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 89, in <listcomp>
    return self._consolidate([self.recursive_tensorize(substruct) for substruct in data_struct])
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 95, in recursive_tensorize
    return map_nested(self._recursive_tensorize, data_struct, map_list=False)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 484, in map_nested
    mapped = function(data_struct)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 89, in _recursive_tensorize
    return self._consolidate([self.recursive_tensorize(substruct) for substruct in data_struct])
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 89, in <listcomp>
    return self._consolidate([self.recursive_tensorize(substruct) for substruct in data_struct])
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 95, in recursive_tensorize
    return map_nested(self._recursive_tensorize, data_struct, map_list=False)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 484, in map_nested
    mapped = function(data_struct)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 92, in _recursive_tensorize
    return self._tensorize(data_struct)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 54, in _tensorize
    elif isinstance(value, (np.character, np.ndarray)) and np.issubdtype(value.dtype, np.character):
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/numpy/core/numerictypes.py", line 416, in issubdtype
    if not issubclass_(arg1, generic):
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/numpy/core/numerictypes.py", line 320, in issubclass_
    return issubclass(arg1, arg2)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/numpy/core/numerictypes.py", line 320, in issubclass_
    return issubclass(arg1, arg2)
TypeError: issubclass() arg 1 must be a class
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/andreafabbricatore/rainbot/src/train_segments_vit.py", line 128, in <module>
    trainer.train()
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/transformers/trainer.py", line 1553, in train
    return inner_training_loop(
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/transformers/trainer.py", line 1813, in _inner_training_loop
    for step, inputs in enumerate(epoch_iterator):
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/accelerate/data_loader.py", line 561, in __iter__
    next_batch = next(dataloader_iter)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 50, in fetch
    data = self.dataset.__getitems__(possibly_batched_index)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 2876, in __getitems__
    batch = self.__getitem__(keys)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 2872, in __getitem__
    return self._getitem(key)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 2857, in _getitem
    formatted_output = format_table(
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/formatting.py", line 647, in format_table
    formatted_output = formatter(pa_table_to_format, query_type=query_type)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/formatting.py", line 407, in __call__
    return self.format_batch(pa_table)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 112, in format_batch
    batch = self.recursive_tensorize(batch)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 95, in recursive_tensorize
    return map_nested(self._recursive_tensorize, data_struct, map_list=False)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 511, in map_nested
    mapped = [
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 512, in <listcomp>
    _single_map_nested((function, obj, batched, batch_size, types, None, True, None))
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 373, in _single_map_nested
    return function(data_struct)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 89, in _recursive_tensorize
    return self._consolidate([self.recursive_tensorize(substruct) for substruct in data_struct])
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 89, in <listcomp>
    return self._consolidate([self.recursive_tensorize(substruct) for substruct in data_struct])
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 95, in recursive_tensorize
    return map_nested(self._recursive_tensorize, data_struct, map_list=False)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 484, in map_nested
    mapped = function(data_struct)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 89, in _recursive_tensorize
    return self._consolidate([self.recursive_tensorize(substruct) for substruct in data_struct])
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 89, in <listcomp>
    return self._consolidate([self.recursive_tensorize(substruct) for substruct in data_struct])
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 95, in recursive_tensorize
    return map_nested(self._recursive_tensorize, data_struct, map_list=False)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 484, in map_nested
    mapped = function(data_struct)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 89, in _recursive_tensorize
    return self._consolidate([self.recursive_tensorize(substruct) for substruct in data_struct])
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 89, in <listcomp>
    return self._consolidate([self.recursive_tensorize(substruct) for substruct in data_struct])
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 95, in recursive_tensorize
    return map_nested(self._recursive_tensorize, data_struct, map_list=False)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 484, in map_nested
    mapped = function(data_struct)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 92, in _recursive_tensorize
    return self._tensorize(data_struct)
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/datasets/formatting/torch_formatter.py", line 54, in _tensorize
    elif isinstance(value, (np.character, np.ndarray)) and np.issubdtype(value.dtype, np.character):
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/numpy/core/numerictypes.py", line 416, in issubdtype
    if not issubclass_(arg1, generic):
  File "/home/andreafabbricatore/.local/lib/python3.10/site-packages/numpy/core/numerictypes.py", line 320, in issubclass_
    return issubclass(arg1, arg2)
KeyboardInterrupt